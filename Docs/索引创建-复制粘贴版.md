# ç´¢å¼•åˆ›å»º - å¤åˆ¶ç²˜è´´ç‰ˆ

> æœ€ç®€åŒ–çš„ç´¢å¼•åˆ›å»ºæŒ‡å¼•ï¼Œé€‚åˆå¿«é€Ÿæ‰¹é‡åˆ›å»º

## ğŸ¯ ä½¿ç”¨è¯´æ˜

1. æ‰“å¼€äº‘å¼€å‘æ§åˆ¶å° â†’ æ•°æ®åº“ â†’ é›†åˆç®¡ç†
2. é€‰æ‹©é›†åˆ â†’ ç´¢å¼•ç®¡ç† â†’ æ–°å»ºç´¢å¼•
3. **å¤åˆ¶ä¸‹é¢çš„é…ç½®**ï¼Œåœ¨è¡¨å•ä¸­å¡«å†™
4. åˆ›å»ºæˆåŠŸåï¼Œåœ¨ä¸‹é¢æ‰“é’© âœ…

---

## ğŸ“‹ ç´¢å¼•åˆ›å»ºæ¸…å•ï¼ˆ32 ä¸ªï¼‰

### 1ï¸âƒ£ users é›†åˆï¼ˆ3 ä¸ªç´¢å¼•ï¼‰

#### âœ… ç´¢å¼• 1/28

```
é›†åˆ: users
ç´¢å¼•åç§°: openId_unique
å­—æ®µ1: openId | å‡åº(1) | âœ…å‹¾é€‰å”¯ä¸€ç´¢å¼•
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

#### âœ… ç´¢å¼• 2/28

```
é›†åˆ: users
ç´¢å¼•åç§°: level_points_ranking
å­—æ®µ1: level | é™åº(-1)
å­—æ®µ2: points | é™åº(-1)
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

#### âœ… ç´¢å¼• 3/28

```
é›†åˆ: users
ç´¢å¼•åç§°: lastLoginAt_index
å­—æ®µ1: lastLoginAt | é™åº(-1)
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

---

### 2ï¸âƒ£ user_sessions é›†åˆï¼ˆ2 ä¸ªç´¢å¼•ï¼Œè·³è¿‡ TTLï¼‰

#### âœ… ç´¢å¼• 4/28

```
é›†åˆ: user_sessions
ç´¢å¼•åç§°: userId_expiresAt_index
å­—æ®µ1: userId | å‡åº(1)
å­—æ®µ2: expiresAt | å‡åº(1)
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

#### âœ… ç´¢å¼• 5/28

```
é›†åˆ: user_sessions
ç´¢å¼•åç§°: accessToken_index
å­—æ®µ1: accessToken | å‡åº(1)
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

---

### 3ï¸âƒ£ meals é›†åˆï¼ˆ4 ä¸ªç´¢å¼•ï¼‰â­ æœ€é‡è¦

#### âœ… ç´¢å¼• 6/28 â­â­â­â­â­ æœ€é«˜ä¼˜å…ˆçº§

```
é›†åˆ: meals
ç´¢å¼•åç§°: userId_mealDate_index
å­—æ®µ1: userId | å‡åº(1)
å­—æ®µ2: mealDate | é™åº(-1)
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

#### âœ… ç´¢å¼• 7/28

```
é›†åˆ: meals
ç´¢å¼•åç§°: userId_createdAt_index
å­—æ®µ1: userId | å‡åº(1)
å­—æ®µ2: createdAt | é™åº(-1)
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

#### âœ… ç´¢å¼• 8/28 â­â­â­â­â­ é˜²é‡

```
é›†åˆ: meals
ç´¢å¼•åç§°: userId_source_orderId_unique
å­—æ®µ1: userId | å‡åº(1)
å­—æ®µ2: source | å‡åº(1)
å­—æ®µ3: sourceOrderId | å‡åº(1)
âœ…å‹¾é€‰å”¯ä¸€ç´¢å¼•
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

**æ³¨æ„**ï¼šå¦‚æœæœ‰"ç¨€ç–ç´¢å¼•"é€‰é¡¹ï¼Œä¹Ÿå‹¾é€‰ä¸Šã€‚

#### âœ… ç´¢å¼• 9/28

```
é›†åˆ: meals
ç´¢å¼•åç§°: isPublic_createdAt_index
å­—æ®µ1: isPublic | å‡åº(1)
å­—æ®µ2: createdAt | é™åº(-1)
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

---

### 4ï¸âƒ£ daily_stats é›†åˆï¼ˆ3 ä¸ªç´¢å¼•ï¼‰

#### âœ… ç´¢å¼• 10/28 â­â­â­â­â­

```
é›†åˆ: daily_stats
ç´¢å¼•åç§°: userId_date_index
å­—æ®µ1: userId | å‡åº(1)
å­—æ®µ2: date | é™åº(-1)
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

#### âœ… ç´¢å¼• 11/28

```
é›†åˆ: daily_stats
ç´¢å¼•åç§°: date_carbonReduction_ranking
å­—æ®µ1: date | é™åº(-1)
å­—æ®µ2: totalCarbonReduction | é™åº(-1)
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

#### âœ… ç´¢å¼• 12/28 â­â­â­â­â­

```
é›†åˆ: daily_stats
ç´¢å¼•åç§°: userId_date_unique
å­—æ®µ1: userId | å‡åº(1)
å­—æ®µ2: date | å‡åº(1)
âœ…å‹¾é€‰å”¯ä¸€ç´¢å¼•
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

---

### 5ï¸âƒ£ gardens é›†åˆï¼ˆ1 ä¸ªç´¢å¼•ï¼‰

#### âœ… ç´¢å¼• 13/28 â­â­â­â­â­

```
é›†åˆ: gardens
ç´¢å¼•åç§°: userId_unique
å­—æ®µ1: userId | å‡åº(1)
âœ…å‹¾é€‰å”¯ä¸€ç´¢å¼•
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

---

### 6ï¸âƒ£ ingredients é›†åˆï¼ˆ2 ä¸ªç´¢å¼•ï¼‰

#### âœ… ç´¢å¼• 14/28

```
é›†åˆ: ingredients
ç´¢å¼•åç§°: name_index
å­—æ®µ1: name | å‡åº(1)
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

#### âœ… ç´¢å¼• 15/28

```
é›†åˆ: ingredients
ç´¢å¼•åç§°: category_index
å­—æ®µ1: category | å‡åº(1)
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

---

### 7ï¸âƒ£ recipes é›†åˆï¼ˆ1 ä¸ªç´¢å¼•ï¼‰

#### âœ… ç´¢å¼• 16/28

```
é›†åˆ: recipes
ç´¢å¼•åç§°: usageCount_index
å­—æ®µ1: usageCount | é™åº(-1)
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

---

### 8ï¸âƒ£ sync_tasks é›†åˆï¼ˆ3 ä¸ªç´¢å¼•ï¼‰

#### âœ… ç´¢å¼• 17/28

```
é›†åˆ: sync_tasks
ç´¢å¼•åç§°: userId_platform_status_index
å­—æ®µ1: userId | å‡åº(1)
å­—æ®µ2: platform | å‡åº(1)
å­—æ®µ3: status | å‡åº(1)
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

#### âœ… ç´¢å¼• 18/28

```
é›†åˆ: sync_tasks
ç´¢å¼•åç§°: status_nextRetry_index
å­—æ®µ1: status | å‡åº(1)
å­—æ®µ2: nextRetry | å‡åº(1)
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

#### âœ… ç´¢å¼• 19/28

```
é›†åˆ: sync_tasks
ç´¢å¼•åç§°: platform_orderId_unique
å­—æ®µ1: platform | å‡åº(1)
å­—æ®µ2: orderId | å‡åº(1)
âœ…å‹¾é€‰å”¯ä¸€ç´¢å¼•
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

---

### 9ï¸âƒ£ platform_configs é›†åˆï¼ˆ1 ä¸ªç´¢å¼•ï¼‰

#### âœ… ç´¢å¼• 20/28

```
é›†åˆ: platform_configs
ç´¢å¼•åç§°: platform_unique
å­—æ®µ1: platform | å‡åº(1)
âœ…å‹¾é€‰å”¯ä¸€ç´¢å¼•
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

---

### ğŸ”Ÿ friends é›†åˆï¼ˆ2 ä¸ªç´¢å¼•ï¼‰

#### âœ… ç´¢å¼• 21/28

```
é›†åˆ: friends
ç´¢å¼•åç§°: userId_friendId_unique
å­—æ®µ1: userId | å‡åº(1)
å­—æ®µ2: friendId | å‡åº(1)
âœ…å‹¾é€‰å”¯ä¸€ç´¢å¼•
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

#### âœ… ç´¢å¼• 22/28

```
é›†åˆ: friends
ç´¢å¼•åç§°: userId_status_index
å­—æ®µ1: userId | å‡åº(1)
å­—æ®µ2: status | å‡åº(1)
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

---

### 1ï¸âƒ£1ï¸âƒ£ posts é›†åˆï¼ˆ2 ä¸ªç´¢å¼•ï¼‰

#### âœ… ç´¢å¼• 23/28

```
é›†åˆ: posts
ç´¢å¼•åç§°: userId_createdAt_index
å­—æ®µ1: userId | å‡åº(1)
å­—æ®µ2: createdAt | é™åº(-1)
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

#### âœ… ç´¢å¼• 24/28

```
é›†åˆ: posts
ç´¢å¼•åç§°: visibility_createdAt_index
å­—æ®µ1: visibility | å‡åº(1)
å­—æ®µ2: createdAt | é™åº(-1)
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

---

### 1ï¸âƒ£2ï¸âƒ£ orders é›†åˆï¼ˆ2 ä¸ªç´¢å¼•ï¼‰

#### âœ… ç´¢å¼• 25/28 â­â­â­â­â­

```
é›†åˆ: orders
ç´¢å¼•åç§°: orderNo_unique
å­—æ®µ1: orderNo | å‡åº(1)
âœ…å‹¾é€‰å”¯ä¸€ç´¢å¼•
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

#### âœ… ç´¢å¼• 26/28

```
é›†åˆ: orders
ç´¢å¼•åç§°: userId_createdAt_index
å­—æ®µ1: userId | å‡åº(1)
å­—æ®µ2: createdAt | é™åº(-1)
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

---

## ğŸ¯ æœ€å 2 ä¸ªç´¢å¼•ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰

### è¿½åŠ  users é›†åˆçš„ç´¢å¼•

#### âœ… ç´¢å¼• 27/28

```
é›†åˆ: user_sessions
ç´¢å¼•åç§°: userId_index
å­—æ®µ1: userId | å‡åº(1)
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

#### âœ… ç´¢å¼• 28/32

```
é›†åˆ: meals
ç´¢å¼•åç§°: userId_index
å­—æ®µ1: userId | å‡åº(1)
```

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

---

### ğŸ†• meat_products é›†åˆï¼ˆ4 ä¸ªç´¢å¼•ï¼‰â­ æ–°å¢

#### âœ… ç´¢å¼• 29/32 â­â­â­â­â­ æœ€é«˜ä¼˜å…ˆçº§

```
é›†åˆ: meat_products
ç´¢å¼•åç§°: name_unique
å­—æ®µ1: name | å‡åº(1) | âœ…å‹¾é€‰å”¯ä¸€ç´¢å¼•
```

**è¯´æ˜**ï¼š
- ç”¨äºæŸ¥è¯¢è‚‰ç±»äº§å“ï¼ˆgetMeatAlternativesåŠŸèƒ½ï¼‰
- ç¡®ä¿è‚‰ç±»åç§°å”¯ä¸€ï¼Œé¿å…é‡å¤æ•°æ®
- æ”¯æŒå¿«é€ŸæŸ¥æ‰¾

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

#### âœ… ç´¢å¼• 30/32 â­â­â­â­ é«˜ä¼˜å…ˆçº§

```
é›†åˆ: meat_products
ç´¢å¼•åç§°: category_subcategory_index
å­—æ®µ1: category | å‡åº(1)
å­—æ®µ2: subcategory | å‡åº(1)
```

**è¯´æ˜**ï¼š
- ç”¨äºåˆ†ç±»ç»Ÿè®¡ï¼ˆred_meat/poultry/seafood/processed_meatï¼‰
- æ”¯æŒå­åˆ†ç±»æŸ¥è¯¢ï¼ˆbeef/pork/lamb/chickenç­‰ï¼‰
- ä¼˜åŒ–èšåˆæŸ¥è¯¢æ€§èƒ½

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

#### âœ… ç´¢å¼• 31/32 â­â­â­ ä¸­ä¼˜å…ˆçº§

```
é›†åˆ: meat_products
ç´¢å¼•åç§°: carbonFootprint_index
å­—æ®µ1: carbonFootprint | é™åº(-1)
```

**è¯´æ˜**ï¼š
- ç”¨äºæŒ‰ç¢³è¶³è¿¹æ’åºï¼ˆé«˜åˆ°ä½ï¼‰
- æ”¯æŒæ•™è‚²å±•ç¤ºé¡µé¢
- å¯é€‰ç´¢å¼•ï¼Œå½±å“è¾ƒå°

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

#### âœ… ç´¢å¼• 32/32 â­â­â­ ä¸­ä¼˜å…ˆçº§

```
é›†åˆ: meat_products
ç´¢å¼•åç§°: status_index
å­—æ®µ1: status | å‡åº(1)
```

**è¯´æ˜**ï¼š
- ç”¨äºè¿‡æ»¤æ´»è·ƒçŠ¶æ€çš„è‚‰ç±»æ•°æ®
- æ”¯æŒæ•°æ®ç®¡ç†
- å¯é€‰ç´¢å¼•

åˆ›å»ºå®Œæˆæ‰“é’©ï¼šâ–¡

---

## ğŸ“Š è¿›åº¦ç»Ÿè®¡

åˆ›å»ºå®Œæˆåç»Ÿè®¡ï¼š

- users: â–¡â–¡â–¡ (3 ä¸ª)
- user_sessions: â–¡â–¡ (2 ä¸ª)
- meals: â–¡â–¡â–¡â–¡ (4 ä¸ª)
- daily_stats: â–¡â–¡â–¡ (3 ä¸ª)
- gardens: â–¡ (1 ä¸ª)
- ingredients: â–¡â–¡ (2 ä¸ª)
- recipes: â–¡ (1 ä¸ª)
- sync_tasks: â–¡â–¡â–¡ (3 ä¸ª)
- platform_configs: â–¡ (1 ä¸ª)
- friends: â–¡â–¡ (2 ä¸ª)
- posts: â–¡â–¡ (2 ä¸ª)
- orders: â–¡â–¡ (2 ä¸ª)
- **meat_products: â–¡â–¡â–¡â–¡ (4 ä¸ª)** â­ æ–°å¢

**æ€»è¿›åº¦**: \_\_\_/32

---

## â±ï¸ æ—¶é—´ä¼°ç®—

- æ¯ä¸ªç´¢å¼•çº¦ 30-60 ç§’
- 32 ä¸ªç´¢å¼• Ã— 45 ç§’ â‰ˆ **24 åˆ†é’Ÿ**
- å¦‚æœåªåˆ›å»ºæ ¸å¿ƒç´¢å¼•ï¼ˆå‰ 13 ä¸ªï¼‰â‰ˆ **10 åˆ†é’Ÿ**
- meat_products ç´¢å¼•ï¼ˆ4 ä¸ªï¼‰â‰ˆ **3 åˆ†é’Ÿ**

---

## ğŸ’¡ æ“ä½œæŠ€å·§

### åŠ é€Ÿåˆ›å»ºçš„æ–¹æ³•

1. **åŒå±æ“ä½œ**: ä¸€ä¸ªå±å¹•çœ‹æ–‡æ¡£ï¼Œä¸€ä¸ªå±å¹•æ“ä½œæ§åˆ¶å°
2. **å¤åˆ¶ç²˜è´´**: ç›´æ¥å¤åˆ¶"ç´¢å¼•åç§°"å’Œ"å­—æ®µå"
3. **å¿«æ·é”®**:
   - Tab é”®åˆ‡æ¢è¾“å…¥æ¡†
   - Enter ç¡®è®¤
4. **åˆ†æ‰¹åˆ›å»º**:
   - å…ˆåˆ›å»ºæœ€é«˜ä¼˜å…ˆçº§ï¼ˆâ­â­â­â­â­ï¼‰
   - ä¼‘æ¯ä¸€ä¸‹
   - å†åˆ›å»ºå…¶ä»–çš„

### é¿å…é”™è¯¯çš„è¦ç‚¹

âœ… **å­—æ®µåè¦å®Œå…¨ä¸€è‡´**ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰

- âœ… `userId` ï¼ˆæ­£ç¡®ï¼‰
- âŒ `userid` ï¼ˆé”™è¯¯ï¼‰
- âŒ `UserId` ï¼ˆé”™è¯¯ï¼‰

âœ… **å‡åºé™åºè¦æ­£ç¡®**

- å‡åºï¼šé€‰æ‹© 1 æˆ– ASC
- é™åºï¼šé€‰æ‹© -1 æˆ– DESC

âœ… **å”¯ä¸€ç´¢å¼•è¦å‹¾é€‰**

- å¸¦ `_unique` ç»“å°¾çš„éƒ½è¦å‹¾é€‰

---

## ğŸ¯ ä¼˜å…ˆçº§åˆ†é…

### ç¬¬ä¸€æ‰¹ï¼ˆå¿…é¡»ï¼Œ8 ä¸ªï¼Œ6 åˆ†é’Ÿï¼‰

1. openId_unique
2. userId_mealDate_index
3. userId_source_orderId_unique
4. userId_date_index
5. userId_date_unique
6. userId_unique (gardens)
7. orderNo_unique
8. **name_unique (meat_products)** â­ æ–°å¢

**å®Œæˆè¿™ 8 ä¸ªåï¼Œæ ¸å¿ƒåŠŸèƒ½å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ï¼**

### ç¬¬äºŒæ‰¹ï¼ˆå»ºè®®ï¼Œ14 ä¸ªï¼Œ10 åˆ†é’Ÿï¼‰

9-22 å·ç´¢å¼•

### ç¬¬ä¸‰æ‰¹ï¼ˆå¯é€‰ï¼Œ10 ä¸ªï¼Œ8 åˆ†é’Ÿï¼‰

23-32 å·ç´¢å¼•ï¼ˆå«meat_productså‰©ä½™3ä¸ªç´¢å¼•ï¼‰

---

## ğŸ“± æ§åˆ¶å°å¿«æ·è·¯å¾„

```
https://console.cloud.tencent.com/tcb/db/collection/my-garden-app-env-4e0h762923be2f

â†“ ç‚¹å‡»é›†åˆåç§°

â†“ ç‚¹å‡»ã€Œç´¢å¼•ç®¡ç†ã€æ ‡ç­¾

â†“ ç‚¹å‡»ã€Œæ–°å»ºç´¢å¼•ã€

â†“ å¤åˆ¶ä¸Šé¢çš„é…ç½®å¡«å†™

â†“ ç‚¹å‡»ã€Œç¡®å®šã€

â†“ å®Œæˆï¼åœ¨ä¸Šé¢æ‰“é’© âœ…
```

---

## âœ… éªŒè¯ç´¢å¼•åˆ›å»ºæˆåŠŸ

åˆ›å»ºåï¼Œåœ¨ç´¢å¼•ç®¡ç†é¡µé¢åº”è¯¥çœ‹åˆ°ï¼š

**users é›†åˆç¤ºä¾‹**ï¼š

```
âœ“ _id_                    (ç³»ç»Ÿé»˜è®¤)
âœ“ _openid_                (ç³»ç»Ÿé»˜è®¤ï¼Œå¯èƒ½æœ‰)
âœ“ openId_unique           (æ‚¨åˆ›å»ºçš„) â† æ–°å¢
âœ“ level_points_ranking    (æ‚¨åˆ›å»ºçš„) â† æ–°å¢
âœ“ lastLoginAt_index       (æ‚¨åˆ›å»ºçš„) â† æ–°å¢
```

---

**å¼€å§‹æ—¶é—´**: ****\_\_\_\_****  
**å®Œæˆæ—¶é—´**: ****\_\_\_\_****  
**æ€»è€—æ—¶**: ****\_\_\_\_****

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.1  
**åˆ›å»ºæ—¥æœŸ**: 2025-01-11  
**æ›´æ–°æ—¥æœŸ**: 2025-10-14  
**ç›®æ ‡**: å¿«é€Ÿå®Œæˆ 32 ä¸ªç´¢å¼•åˆ›å»ºï¼ˆå«meat_productsé›†åˆ4ä¸ªç´¢å¼•ï¼‰
