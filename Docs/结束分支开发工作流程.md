# 结束分支开发工作流程指南

## 概述
本文档详细说明了如何规范地结束一个功能分支的开发工作，包括代码提交、代码审查、分支合并和清理等完整流程。

## 完整工作流程

### 1. 完成开发工作
在结束分支前，确保：
- ✅ 功能实现完整且符合需求
- ✅ 代码经过充分测试
- ✅ 没有明显的bug或问题
- ✅ 代码符合项目规范

### 2. 提交所有更改

```bash
# 检查当前状态
git status

# 添加所有更改到暂存区
git add .

# 提交更改（使用有意义的提交信息）
git commit -m "feat: 完成[功能名称]开发"

# 如果之前已经提交过，确保所有更改都已提交
git log --oneline -5  # 查看最近提交记录
```

**提交信息规范**：
- `feat:` - 新功能
- `fix:` - 修复bug  
- `docs:` - 文档更新
- `style:` - 代码格式调整
- `refactor:` - 代码重构
- `test:` - 测试相关
- `chore:` - 构建过程或辅助工具变动

### 3. 同步远程仓库

```bash
# 推送当前分支到远程仓库
git push origin [分支名称]

# 示例
git push origin 用户系统开发
```

### 4. 创建Pull Request (PR)

**在代码托管平台操作**：
1. 进入项目仓库页面
2. 点击"New Pull Request"或"创建合并请求"
3. 配置分支信息：
   - **源分支**：你的功能分支（如：`用户系统开发`）
   - **目标分支**：开发分支（如：`develop`）或主分支（如：`main`）
4. 填写PR信息：
   - **标题**：清晰描述功能（如："用户系统开发功能合并"）
   - **描述**：详细说明功能变更、测试情况、影响范围

**PR描述模板**：
```markdown
## 功能描述
[简要描述实现的功能]

## 变更内容
- [ ] 功能点1
- [ ] 功能点2
- [ ] 功能点3

## 测试情况
- [ ] 单元测试通过
- [ ] 集成测试通过
- [ ] 功能测试完成

## 影响范围
- [ ] 数据库变更
- [ ] API接口变更
- [ ] 前端页面变更

## 注意事项
[需要特别关注的问题或配置变更]
```

### 5. 代码审查流程

**审查者操作**：
1. 仔细阅读代码变更
2. 检查代码质量和规范
3. 测试功能是否正常
4. 提供审查意见

**开发者操作**：
1. 根据审查意见修改代码
2. 提交新的更改
3. 在PR中回复审查意见
4. 请求重新审查

```bash
# 根据审查意见修改后
git add .
git commit -m "fix: 根据审查意见修复[具体问题]"
git push origin [分支名称]
```

### 6. 合并分支

审查通过后，合并分支：

```bash
# 切换到目标分支
git checkout develop

# 拉取最新代码
git pull origin develop

# 合并功能分支
git merge [分支名称]

# 解决可能的冲突（如果有）
# 提交合并结果
git push origin develop
```

**合并选项**：
- **普通合并**：保留完整提交历史
- **压缩合并**：将多个提交合并为一个（适合功能分支）

### 7. 分支清理（可选）

```bash
# 删除本地分支
git branch -d [分支名称]

# 如果分支未完全合并，强制删除
git branch -D [分支名称]

# 删除远程分支
git push origin --delete [分支名称]
```

### 8. 开始新的开发工作

```bash
# 切换到开发分支
git checkout develop

# 拉取最新代码
git pull origin develop

# 创建新功能分支
git checkout -b feature/[新功能名称] develop
```

## 特殊情况处理

### 合并冲突解决
```bash
# 出现冲突时，手动解决冲突文件
# 标记冲突已解决
git add [冲突文件]

# 完成合并
git commit
```

### 分支保留策略
**需要保留分支的情况**：
- 功能可能还需要后续修改
- 作为版本发布的基准分支
- 长期维护的功能分支

**建议在PR描述中注明保留原因**

## 最佳实践

### 开发期间
- 小步提交，频繁推送
- 保持分支与目标分支同步
- 及时解决冲突

### 代码质量
- 编写清晰的提交信息
- 确保代码通过所有测试
- 遵循项目编码规范

### 团队协作
- 及时请求代码审查
- 积极回应审查意见
- 保持沟通畅通

## 常见问题

### Q: PR创建后发现有bug怎么办？
A: 直接在功能分支上修复，提交并推送到远程，PR会自动更新。

### Q: 多个功能分支如何管理？
A: 每个功能独立分支，按优先级依次合并。

### Q: 分支命名规范？
A: 建议使用：`feature/功能名称`、`fix/bug描述`、`hotfix/紧急修复`

---

*最后更新：2025年10月11日*  
*文档维护：开发团队*