# AI编码执行步骤文档 - 我的花园微信小程序

## 1. 项目概述

### 目标
通过AI协作完成微信小程序"我的花园"的基础框架搭建，包括前端、后端和核心功能系统。

### 技术栈
- **前端**: Taro 3.6.38 + React 18.3.1 + TypeScript
- **后端**: 腾讯云开发 (CloudBase)
- **数据库**: MongoDB (腾讯云内置文档型数据库)
- **UI框架**: Taro UI组件库 + CSS Modules
- **状态管理**: React Hooks (useState, useEffect等)
- **云函数**: Node.js 16.13 + wx-server-sdk

### 约束条件
- 每个步骤必须是独立可执行的任务
- 提示词要明确具体，避免歧义
- 每个步骤完成后需要验证和确认

## 2. 执行原则

### 2.1 原子性原则
每个步骤只完成一个明确的功能模块，避免功能混杂。

### 2.2 可验证原则
每个步骤必须有明确的验收标准和验证方法。

### 2.3 回滚原则
每个步骤的设计要支持独立回滚，不影响其他功能。

## 3. 任务分解与提示词模板

### 阶段一：项目基础框架搭建（已完成）

#### 步骤1.1 - 项目初始化 ✅
**完成状态**: 已实现
**验收结果**: 项目结构完整，开发环境配置正确

#### 步骤1.2 - 腾讯云开发环境配置 ✅
**完成状态**: 已实现
**验收结果**: 云环境连接正常，云函数部署成功

### 阶段二：用户系统开发（已完成）

#### 步骤2.1 - 微信登录功能 ✅
**完成状态**: 已实现
**验收结果**: 微信授权登录正常，用户信息存储成功

#### 步骤2.2 - 基础界面集成 ✅
**完成状态**: 已实现
**验收结果**: 底部Tab导航、页面路由配置完成

### 阶段三：核心功能开发（已完成）

#### 步骤3.1 - 花园系统功能 ✅
**完成状态**: 已实现
**验收结果**: 花园页面功能完整，植物种植、成长系统、场景切换、积分机制均已实现

**实现内容**:
- 花园主页面布局和样式
- 植物种植和成长系统（含成长动画）
- 花园场景切换功能（春夏秋冬四季）
- 积分种植机制（消耗积分种植植物）
- 植物互动效果（浇水、收获）
- 后端云函数支持完整的植物管理

#### 步骤3.2 - 碳足迹计算功能 ✅
**完成状态**: 已实现
**验收结果**: 碳足迹记录页面功能完整，计算算法准确，与后端云函数集成正常

**实现内容**:
- 素食记录表单页面（carbon/index.tsx）
- 手动输入记录功能（食材类型、重量、烹饪方式）
- 碳足迹计算算法（基于食材类型和重量）
- 后端云函数支持碳足迹计算
- 完整的UI界面和交互体验
=======
#### 步骤3.2 - 碳足迹计算功能 ✅
**完成状态**: 已实现
**验收结果**: 碳足迹记录页面功能完整，计算算法准确，与后端云函数集成正常

**实现内容**:
- 素食记录表单页面（carbon/index.tsx）
- 手动输入记录功能（食材类型、重量、烹饪方式）
- 碳足迹计算算法（基于食材类型和重量）
- 后端云函数支持碳足迹计算
- 完整的UI界面和交互体验
=======
### 阶段四：数据展示与优化（已完成）

#### 步骤4.1 - 数据可视化功能 ✅
**完成状态**: 已实现
**验收结果**: 数据可视化功能完整，图表展示准确，性能表现良好

**实现内容**:
- 创建了完整的图表组件库（LineChart、PieChart、BarChart、ProgressBar）
- 实现了碳足迹统计图表页面，包含标签页切换功能
- 集成了减排趋势可视化（7天趋势折线图）
- 添加了食物类型占比饼图展示
- 实现了月度对比柱状图
- 添加了目标进度条组件
- 优化了数据加载和展示性能

**技术细节**:
- 使用纯CSS实现响应式图表，无需额外依赖
- 支持移动端触摸交互和响应式布局
- 图表组件模块化设计，支持复用
- 与现有碳足迹页面无缝集成

#### 步骤4.2 - 性能优化与测试 ✅
**完成状态**: 已实现
**验收结果**: 性能优化完成，错误处理机制完善，用户体验良好

**实现内容**:
- **构建配置优化**: 添加分包策略，分离第三方库，减少主包体积
- **错误边界组件**: 创建全局错误捕获组件，集成到应用根组件
- **加载状态管理**: 创建Loading组件，集成到所有主要页面
- **页面性能优化**: 为碳足迹、花园、用户页面添加加载状态管理
- **用户体验优化**: 完善错误处理和重试机制，提升应用稳定性

**技术细节**:
- 分包配置优化主包体积，提升加载性能
- ErrorBoundary组件捕获运行时错误，提供优雅降级
- Loading组件统一管理加载状态，提升用户体验
- 所有页面集成错误处理和加载状态管理
- 构建过程无警告，代码质量达标
=======
### 阶段三：核心功能开发（已完成）

#### 步骤3.1 - 花园系统功能 ✅
**完成状态**: 已实现
**验收结果**: 花园页面功能完整，植物种植、成长系统、场景切换、积分机制均已实现

**实现内容**:
- 花园主页面布局和样式
- 植物种植和成长系统（含成长动画）
- 花园场景切换功能（春夏秋冬四季）
- 积分种植机制（消耗积分种植植物）
- 植物互动效果（浇水、收获）
- 后端云函数支持完整的植物管理

#### 步骤3.2 - 碳足迹计算功能 ✅
**完成状态**: 已实现
**验收结果**: 碳足迹记录页面功能完整，计算算法准确，与后端云函数集成正常

**实现内容**:
- 素食记录表单页面（carbon/index.tsx）
- 手动输入记录功能（食材类型、重量、烹饪方式）
- 碳足迹计算算法（基于食材类型和重量）
- 后端云函数支持碳足迹计算
- 完整的UI界面和交互体验

### 阶段四：数据展示与优化（已完成）

#### 步骤4.1 - 数据可视化功能 ✅
**完成状态**: 已实现
**验收结果**: 数据可视化功能完整，图表展示准确，性能表现良好

**实现内容**:
- 创建了完整的图表组件库（LineChart、PieChart、BarChart、ProgressBar）
- 实现了碳足迹统计图表页面，包含标签页切换功能
- 集成了减排趋势可视化（7天趋势折线图）
- 添加了食物类型占比饼图展示
- 实现了月度对比柱状图
- 添加了目标进度条组件
- 优化了数据加载和展示性能

**技术细节**:
- 使用纯CSS实现响应式图表，无需额外依赖
- 支持移动端触摸交互和响应式布局
- 图表组件模块化设计，支持复用
- 与现有碳足迹页面无缝集成

#### 步骤4.2 - 性能优化与测试 ✅
**完成状态**: 已实现
**验收结果**: 性能优化完成，错误处理机制完善，用户体验良好，构建过程无警告

**实现内容**:
- **构建配置优化**: 在config/index.js中添加分包策略，分离第三方库，减少主包体积
- **错误边界组件**: 创建ErrorBoundary组件，集成到应用根组件，提供全局错误捕获
- **加载状态管理**: 创建Loading组件，集成到所有主要页面，统一管理加载状态
- **ScrollView兼容性修复**: 彻底修复花园页面和碳足迹页面的ScrollView padding属性兼容性问题
- **页面性能优化**: 为首页、碳足迹、花园、用户页面添加完善的错误处理和加载状态管理
- **用户体验优化**: 完善错误处理和重试机制，提升应用稳定性

**技术细节**:
- 分包配置优化主包体积，vendors.js 232KB，pages目录 120KB，符合小程序包大小限制
- ErrorBoundary组件捕获运行时错误，提供优雅降级和重试机制
- Loading组件统一管理加载状态，提升用户体验
- 彻底修复ScrollView兼容性问题：移除.scene-selector的padding，为.scene-list和.scene-item使用margin替代
- 所有页面集成错误处理和加载状态管理，应用稳定性显著提升
- 构建过程无警告，代码质量达标，兼容性测试通过
=======
### 阶段三：核心功能开发（已完成）

#### 步骤3.1 - 花园系统功能 ✅
**完成状态**: 已实现
**验收结果**: 花园页面功能完整，植物种植、成长系统、场景切换、积分机制均已实现

**实现内容**:
- 花园主页面布局和样式
- 植物种植和成长系统（含成长动画）
- 花园场景切换功能（春夏秋冬四季）
- 积分种植机制（消耗积分种植植物）
- 植物互动效果（浇水、收获）
- 后端云函数支持完整的植物管理

#### 步骤3.2 - 碳足迹计算功能 ✅
**完成状态**: 已实现
**验收结果**: 碳足迹记录页面功能完整，计算算法准确，与后端云函数集成正常

**实现内容**:
- 素食记录表单页面（carbon/index.tsx）
- 手动输入记录功能（食材类型、重量、烹饪方式）
- 碳足迹计算算法（基于食材类型和重量）
- 后端云函数支持碳足迹计算
- 完整的UI界面和交互体验
=======
#### 步骤3.2 - 碳足迹计算功能 ✅
**完成状态**: 已实现
**验收结果**: 碳足迹记录页面功能完整，计算算法准确，与后端云函数集成正常

**实现内容**:
- 素食记录表单页面（carbon/index.tsx）
- 手动输入记录功能（食材类型、重量、烹饪方式）
- 碳足迹计算算法（基于食材类型和重量）
- 后端云函数支持碳足迹计算
- 完整的UI界面和交互体验

### 阶段四：数据展示与优化（已完成）

#### 步骤4.1 - 数据可视化功能 ✅
**完成状态**: 已实现
**验收结果**: 数据可视化功能完整，图表展示准确，性能表现良好

**实现内容**:
- 创建了完整的图表组件库（LineChart、PieChart、BarChart、ProgressBar）
- 实现了碳足迹统计图表页面，包含标签页切换功能
- 集成了减排趋势可视化（7天趋势折线图）
- 添加了食物类型占比饼图展示
- 实现了月度对比柱状图
- 添加了目标进度条组件
- 优化了数据加载和展示性能

**技术细节**:
- 使用纯CSS实现响应式图表，无需额外依赖
- 支持移动端触摸交互和响应式布局
- 图表组件模块化设计，支持复用
- 与现有碳足迹页面无缝集成

#### 步骤4.2 - 性能优化与测试
**提示词**:
```
请进行性能优化和全面测试。具体要求：
1. 优化页面加载性能
2. 完善错误处理机制
3. 进行兼容性测试
4. 优化用户体验
5. 完成上线前检查

验收标准：
- 页面加载时间达标
- 错误处理完善
- 兼容性测试通过
- 用户体验良好
```

## 4. 质量保证机制

### 4.1 代码质量检查
每个步骤完成后运行：
- ESLint代码规范检查
- TypeScript类型检查
- 基础功能测试

### 4.2 功能验证清单
每个步骤需要验证：
- [ ] 功能实现完整
- [ ] 界面交互正常
- [ ] 数据存储正确
- [ ] 错误处理完善
- [ ] 性能达标

### 4.3 文档更新要求
每个步骤完成后需要：
- 更新项目README文档
- 记录技术实现细节
- 更新API接口文档

## 5. 异常处理机制

### 5.1 常见问题处理
- **编译错误**: 回退到上一步稳定版本
- **API调用失败**: 添加重试机制和错误提示
- **数据不一致**: 实现数据同步和修复机制

### 5.2 回滚策略
每个步骤都要有对应的回滚方案，确保系统稳定性。

## 6. 执行流程控制

### 6.1 步骤执行顺序
严格按照阶段顺序执行，每个阶段内的步骤可以并行执行。

### 6.2 依赖关系管理
- 阶段三依赖阶段一和阶段二完成
- 阶段四依赖阶段三完成
- 当前进度：已完成阶段一、阶段二、阶段三和阶段四

### 6.3 进度跟踪
每个步骤完成后更新进度表，记录完成时间和遇到的问题。

## 7. 文档维护

### 7.1 版本控制
- 文档版本号格式: v1.0.0
- 每次重大更新递增主版本号
- 小修改递增修订版本号

### 7.2 更新记录
- 记录每次修改的内容和原因
- 维护变更日志
- 标注修改人和修改时间

---

**文档版本**: v1.5.0  
**创建时间**: 2025-10-01  
**维护团队**: AI开发助手  
**最后更新**: 2025-10-02 22:35