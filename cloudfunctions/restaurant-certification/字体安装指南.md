# PDF 证书中文字体安装指南

## 问题说明

PDF 证书中的中文显示为乱码，是因为 PDFKit 默认不支持中文字体。需要下载并安装中文字体文件。

## 解决方案

### 步骤 1：下载中文字体

推荐使用 **思源黑体（Source Han Sans）**，这是一个开源的中文字体。

**下载地址：**

- GitHub: https://github.com/adobe-fonts/source-han-sans/releases
- 直接下载简体中文常规字体：https://github.com/adobe-fonts/source-han-sans/raw/release/SubsetOTF/CN/SourceHanSansCN-Regular.otf

**注意：** PDFKit 通常需要 TTF 格式的字体，如果下载的是 OTF 格式，需要转换。

### 步骤 2：放置字体文件

将下载的字体文件重命名为 `SourceHanSansCN-Regular.ttf`，并放置在以下目录：

```
cloudfunctions/restaurant-certification/fonts/SourceHanSansCN-Regular.ttf
```

### 步骤 3：重新部署云函数

```bash
cd /Users/zhangshichao/WeChatProjects/MyGarden
tcb fn deploy restaurant-certification --force
```

### 步骤 4：测试

重新生成证书，检查中文是否正常显示。

## 快速安装脚本

您也可以使用提供的下载脚本：

```bash
cd cloudfunctions/restaurant-certification/fonts
./download-font.sh
```

## 备选方案

如果无法下载思源黑体，您也可以使用其他中文字体：

1. **文泉驿正黑体** - 开源中文字体
2. **微软雅黑** - Windows 系统字体（需授权）
3. **宋体** - 传统中文字体

只需将字体文件重命名为 `SourceHanSansCN-Regular.ttf` 或修改代码中的字体路径即可。

## 验证字体是否加载

部署后，查看云函数日志，如果看到 "中文字体加载成功" 的日志，说明字体已正确加载。

如果看到 "中文字体文件未找到" 的警告，请检查字体文件路径是否正确。
