# 导入"素开心"餐厅菜谱数据 - 执行指南

## 数据说明

本次导入包含 **36 个菜谱**，分为三个类别：

1. **饺包类** (13 款)
2. **小食类** (14 款)
3. **主食粥汤** (9 款)

所有菜谱将关联到"素开心"餐厅（`restaurant_sukuaixin`）。

## 执行方法

### 方法 1：通过云函数调用（推荐）

1. **确保云函数已部署**

   ```bash
   cd cloudfunctions/recipe
   npm install
   # 部署云函数
   tcb fn deploy recipe --force
   ```

2. **在云开发控制台调用**

   - 登录腾讯云开发控制台
   - 进入"云函数" → 找到 `recipe` 函数
   - 点击"测试"或"在线调试"
   - 输入以下参数：
     ```json
     {
       "action": "importSukuaixinRecipes"
     }
     ```
   - 点击"运行测试"

3. **查看执行结果**
   - 执行成功后，会返回导入结果：
     ```json
     {
       "success": true,
       "message": "成功导入 36 个菜谱",
       "results": {
         "created": [...],
         "updated": [...],
         "failed": [...]
       }
     }
     ```

### 方法 2：直接运行脚本（本地测试）

```bash
cd cloudfunctions/recipe
node import-sukuaixin-recipes.js
```

## 菜谱列表

### 饺包类 (13 款)

1. 蒸饺 - 成品
2. 小笼包 - g1x 成品
3. 锅贴 - 待研发
4. 叉烧包 - 待研发
5. 水晶饺 - 待研发
6. 奶黄包 - 待研发
7. 烧麦 - 待研发
8. 松茸汤包
9. 干挑馄饨
10. 生煎包
11. 春卷
12. 象形核桃包 - 甜
13. 豆沙包 - 甜, g1x 成品

### 小食类 (14 款)

1. 香芋卷 - 茹成品
2. 萝卜糕 - g1x 成品
3. 黄金薯球 - 茹成品
4. 芋头糕 - g1x 成品
5. 香酥芋泥卷 - g1x 成品
6. 马蹄糕
7. 椰香糯米滋
8. 木薯糕
9. 麻球 - g1x 成品
10. 煎年糕
11. 菠萝包 - 烘焙成品
12. 腐皮卷
13. 榴莲酥 - 烘焙成品
14. 素塔 - 烘焙成品

### 主食粥汤 (9 款)

1. 小汤圆
2. 肠粉
3. 陈皮红豆沙
4. 汤馄饨
5. 烧仙草
6. 麻油姜汤面 - 成品
7. 珍菌养生粥 - 咸
8. 粉汤饺
9. 过桥米线 - 待研发

## 数据字段说明

每个菜谱包含以下字段：

- `name`: 菜谱名称
- `category`: 分类（staple/ dessert/ soup）
- `cookingMethod`: 烹饪方式（steamed/ boiled/ fried/ baked/ stir_fried）
- `status`: 状态（published/ draft）
- `restaurantId`: 餐厅 ID（restaurant_sukuaixin）
- `description`: 描述
- `ingredients`: 食材列表（初始为空，后续可补充）
- `channels`: 渠道（dine_in/ take_out）
- `version`: 版本号（1）
- `notes`: 备注信息

## 注意事项

1. **幂等性**：脚本支持重复执行，如果菜谱已存在会更新，不存在会创建
2. **餐厅验证**：脚本会先检查"素开心"餐厅是否存在
3. **数据完整性**：初始导入时，食材列表为空，需要后续补充
4. **状态管理**：
   - 已完成的菜谱：`status: 'published'`
   - 待研发的菜谱：`status: 'draft'`

## 验证数据

导入完成后，可以通过以下方式验证：

1. **在云开发控制台查看**

   - 进入"数据库" → `recipes` 集合
   - 筛选 `restaurantId: restaurant_sukuaixin`
   - 应该能看到 36 条记录

2. **在前端应用查看**
   - 登录管理后台
   - 切换到"素开心"餐厅
   - 进入"菜谱管理" → "菜谱列表"
   - 应该能看到所有导入的菜谱

## 后续操作

导入完成后，建议：

1. **补充食材信息**：为每个菜谱添加具体的食材和数量
2. **计算碳足迹**：使用碳足迹计算功能为菜谱计算碳足迹
3. **完善描述**：为菜谱添加更详细的描述信息
4. **上传图片**：为菜谱添加图片（如果支持）

## 故障排查

### 问题 1：餐厅不存在

**错误信息**：`餐厅 restaurant_sukuaixin 不存在`

**解决方案**：

1. 先执行添加"小苹果"租户的脚本
2. 确保"素开心"餐厅已创建

### 问题 2：导入失败

**解决方案**：

1. 查看云函数日志，确认具体错误
2. 检查数据库权限
3. 确认 `recipes` 集合已创建

### 问题 3：部分菜谱导入失败

**解决方案**：

1. 查看返回结果中的 `failed` 数组
2. 根据错误信息修复数据
3. 重新执行导入（已成功的会自动跳过）
