# SPA 路由配置指南 - 解决 404 错误

## 🔴 问题描述

当直接访问 Web 平台的路由（如 `/login`、`/dashboard`）或刷新页面时，会收到 404 错误：

```
404 Not Found
Code: NoSuchKey
Message: The specified key does not exist.
Key: login
```

这是因为单页应用（SPA）的路由是由前端 JavaScript 处理的，服务器上并不存在这些实际路径的文件。

## ✅ 解决方案：配置错误页面重定向

### 方法一：腾讯云控制台配置（推荐）

#### 步骤 1：登录控制台

访问 [腾讯云开发控制台](https://console.cloud.tencent.com/tcb)

#### 步骤 2：选择环境

1. 在控制台中找到您的环境：`my-garden-app-env-4e0h762923be2f`
2. 点击进入该环境

#### 步骤 3：配置静态网站托管

1. 在左侧菜单中选择「**静态网站托管**」
2. 点击「**基础配置**」或「**错误页面**」标签
3. 找到「**错误页面配置**」或「**错误文档**」设置
4. 配置如下：
   - **错误文档**：设置为 `index.html`
   - **状态码**：选择 `404`（如果支持）
   - **重定向规则**：将 404 错误重定向到 `/index.html`

#### 步骤 4：保存并等待生效

1. 点击「**保存**」或「**确认**」
2. 等待 1-5 分钟让配置生效
3. 清除浏览器缓存后重新测试

### 方法二：使用 CloudBase CLI（如果支持）

```bash
# 检查当前配置
tcb hosting config get -e my-garden-app-env-4e0h762923be2f

# 设置错误页面重定向（如果CLI支持）
# 注意：此命令可能不可用，优先使用方法一
```

## 🧪 验证配置

配置完成后，测试以下场景确保正常工作：

1. ✅ **根路径访问**：
   ```
   https://my-garden-app-env-4e0h762923be2f.tcloudbaseapp.com/
   ```
   应该正常显示首页

2. ✅ **直接访问路由**：
   ```
   https://my-garden-app-env-4e0h762923be2f.tcloudbaseapp.com/login
   ```
   应该显示登录页面，而不是 404

3. ✅ **刷新页面**：
   - 在 `/dashboard` 页面刷新
   - 应该正常显示仪表板，而不是 404

4. ✅ **静态资源**：
   ```
   https://my-garden-app-env-4e0h762923be2f.tcloudbaseapp.com/assets/index-xxx.js
   ```
   应该正常加载，不会被重定向

## 📋 配置截图说明

### 控制台位置

```
腾讯云开发控制台
  └── 静态网站托管
      └── 基础配置
          └── 错误页面配置
              └── 错误文档：index.html
```

### 配置要点

- ✅ **错误文档设置为 `index.html`**：所有 404 请求都会返回 `index.html`
- ✅ **React Router 接管路由**：前端路由系统会自动处理 URL 路径
- ✅ **静态资源不受影响**：`/assets/*` 和 `/static/*` 路径不会被重定向

## 🔧 技术原理

1. **服务器层面**：当访问 `/login` 时，服务器找不到该文件，返回 404
2. **错误页面配置**：腾讯云静态网站托管将 404 错误重定向到 `index.html`
3. **前端路由**：React Router 读取 URL 路径，渲染对应的组件（如 Login 组件）
4. **用户体验**：用户看到的是正确的页面，而不是 404 错误

## ⚠️ 注意事项

1. **配置生效时间**：配置保存后可能需要 1-5 分钟才能生效
2. **清除缓存**：配置后建议清除浏览器缓存后再测试
3. **静态资源路径**：确保静态资源（如 `/assets/`、`/static/`）不会被错误重定向
4. **API 请求**：确保 API 请求路径不会被错误重定向

## 🐛 常见问题

### Q1: 配置后仍然出现 404？

**A**: 
- 等待几分钟让配置生效
- 清除浏览器缓存（Ctrl+Shift+Delete 或 Cmd+Shift+Delete）
- 使用无痕模式测试
- 检查配置是否正确保存

### Q2: 静态资源（JS/CSS）无法加载？

**A**: 
- 检查静态资源的路径是否正确
- 确保错误页面配置不会影响 `/assets/*` 路径
- 查看浏览器控制台的网络请求

### Q3: 配置在哪里找不到？

**A**: 
- 确认您使用的是「静态网站托管」服务
- 如果找不到，可能需要在「基础配置」或「高级配置」中查找
- 不同版本的腾讯云控制台界面可能略有不同

## 📞 获取帮助

如果以上方法都无法解决问题，请：

1. 检查 [腾讯云静态网站托管文档](https://cloud.tencent.com/document/product/876/40270)
2. 联系腾讯云技术支持
3. 查看项目文档：`ROUTING_CONFIG.md`

---

**最后更新**：2024年
**适用环境**：`my-garden-app-env-4e0h762923be2f`






